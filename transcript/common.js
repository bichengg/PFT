"use strict";var app=angular.module("app",["ui.router"]);app.config(["$httpProvider",function(t){t.defaults.transformRequest=function(t){var e=[];for(var r in t)e.push(encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return e.join("&")},t.defaults.headers.post={"Content-Type":"application/x-www-form-urlencoded"}}]).filter("trans2sex",function(){return function(t){return 1==t?"男":2==t?"女":void 0}}).filter("trans2nation",function(){return function(t){return 1==t?"汉族":"其他"}}).filter("trans2score",function(){return function(t,e,r,n){41==e||42==e?e=4142:43!=e&&44!=e||(e=4344);var o=trans_4142_1_lung,a=0;t=parseFloat(t);for(var c=0;c<o.length-1;c++)t>=o[c].a&&t<o[c+1].a?a=o[c].b:t>=o[c+1].a&&(a=o[c+1].b);return a}}).filter("transBMI2score",function(){return function(t,e){return 1==e?t>17.9&&t<=23.9?100:t<=17.8?80:t>24&&t<=27.9?80:t>=28?60:0:t>17.2&&t<=23.9?100:t<=17.1?80:t>24&&t<=27.9?80:t>=28?60:0}}).filter("transBMI2level",function(){return function(t,e){return 1==e?t>17.9&&t<=23.9?"正常":t<=17.8?"低体重":t>24&&t<=27.9?"超重":t>=28?"肥胖":"无":t>17.2&&t<=23.9?"正常":t<=17.1?"低体重":t>24&&t<=27.9?"超重":t>=28?"肥胖":"无"}}).filter("trans2level",function(){return function(t){var e="";return t<=10?e="未测试":t>10&&t<=59?e="不及格":t>59&&t<=79?e="及格":t>79&&t<=89?e="良好":t>89&&(e="优秀"),e}}).filter("trans2exPoint",function(){return function(t,e){var r=0;return t>100&&(r=(t-100)*e),r}}).filter("transScore2not100",function(){return function(t){return t>=100?100:t}}).run(["$rootScope","$state","$stateParams",function(t,e,r){t.$state=e,t.$stateParams=r}]).config(["$stateProvider","$urlRouterProvider",function(t,e){e.otherwise("/login"),t.state("login",{url:"/login",templateUrl:"login.html",controller:"LoginCtrl"}).state("achievement",{url:"/achievement",templateUrl:"achievement.html",controller:"AchievementCtrl",cache:!1})}]).controller("AppCtrl",["$scope",function(t){}]).controller("LoginCtrl",["$scope","$http","$state",function(t,e,r){function n(t){if(t&&8==t.length)return t=t.replace(/(.{4})/,"$1/"),t=t.replace(/(.{7})/,"$1/")}t.app={name:"学生成绩查询"},t.user={},t.login=function(){t.user.name&&t.user.password?8!=t.user.password.length?t.authError="密码位数不正确~":(t.authError="",e({url:"http://127.0.0.1/PFT/api/Public/PhysicalFitnessTest/?service=User.checkLoginStudent",method:"post",data:{username:t.user.name,password:n(t.user.password)}}).success(function(e){0==e.data.code?(sessionStorage.setItem("token",angular.toJson(e.data.info)),r.go("achievement")):t.authError="账号或密码错误~"}).error(function(e){t.authError=e})):t.authError="账号或密码不能为空~"}}]).controller("AchievementCtrl",["$scope","$filter",function(t,e){t.today=new Date,t.info=angular.fromJson(sessionStorage.getItem("token")),t.stu=t.info[0],t.subjectArr=[{key:"lung",name:"肺活量(毫升)",coefficient:.15},{key:"50m",name:"50米跑(秒)",coefficient:.2},{key:"sr",name:"坐位体前屈(厘米)",coefficient:.1},{key:"jump",name:"立定跳远(厘米)",coefficient:.1}];var r=[{key:"pullup",name:"引体向上(男)/一分钟仰卧起坐(女)(次)",coefficient:.1},{key:"1000",name:"1000(男)/800(女)米跑(分•秒)",coefficient:.2}],n=[{key:"situp",name:"引体向上(男)/一分钟仰卧起坐(女)(次)",coefficient:.1},{key:"800",name:"1000(男)/800(女)米跑(分•秒)",coefficient:.2}];1==t.stu.sex?(t.subjectArr=t.subjectArr.concat(r),t.subjectAttachArr=r):(t.subjectArr=t.subjectArr.concat(n),t.subjectAttachArr=n),setTimeout(function(){for(var e=[],r=[],n=0,o=0;o<4;o++){for(var a=$(".4"+(o+1)),c=0,i=0,u=0,s=0;s<a.length;s++)c+=parseFloat(a.eq(s).html()*a.eq(s).attr("c"));e.push(c.toFixed(2)),t.standardScore=e;for(var l=$(".4"+(o+1)+"_attach"),f=0;f<l.length;f++)i+=parseFloat(l.eq(f).html());u=c+i,r.push(u.toFixed(2)),t.totalScore=r,n+=o<=3?u/6:u/2,t.totalScoreSum=n.toFixed(2),t.$apply()}},100)}]);